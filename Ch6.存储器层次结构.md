> 缓存的原理，在计算机系统的实现上就有重要的应用，更不用说在软件系统中了。
>
> 程序的局部性原理很奇妙，让存储器的层次结构得以运转；

##### 疑问

* 高速缓存为何设计为多路组关联？（一组包含多个缓存行）



##### 摘记

* RAM - 随机访问存储器。DRAM和SRAM，后者做高速缓存，前者做主存。断电易失。
* Solid State Disk（SSD），由flash memory（闪存）技术构建。
* 普通硬盘构成：盘面-> 磁道-> 扇区 ；多个盘片的同一磁道，称为柱面；
* 磁盘容量有2个因素决定：一个是记录密度，决定一个扇区可以存储多少bit位；以及磁道密度；
* 盘面以固定速度旋转，常规的有7200转/min；
* 影响扇区读取时间的因素：寻道时间（主要时间，3-9ms）  +  盘面旋转延时（主要时间，毫秒级）  +  传送时间。



* cpu读取磁盘数据到内存的过程：发送指令后，磁盘控制器获取控制器，通过io总线，把数据复制到内存，过程中CPU并不感知，这称为DMA，完成后，触发中断，cpu接着再回来继续干活。IO慢操作异步化，cpu不用等待IO完成。
* 局部性—程序的基本、持久的属性。弥合CPU和内存（及磁盘）之间数量级的性能差异的关键。
  * 即：程序倾向于使用其地址接近或等于最近使用过的数据和指令。包括时间局部性和空间局部性。

* 良好的程序局部性带来良好的性能。
  * 专业程序员的能力之一：能看到程序中的局部性。（一种直觉、感觉）
* 二维数组是以行优选顺序进行存储的。
* 循环遍历数组，称为stride-1 引用模式（1步长引用模式），有很好的空间局部性。



* Cache(缓存)，它是个更小更快的存储设备，充当更慢的设备的数据的暂存区域。存储器层次结构就是次思路。基于原理就是程序的局部性，即程序更倾向于访问第k层的数据，比k+1层的更频繁（常用数据缓存到第k层）。反之亦然，由于不经常访问k+1层数据，因此可以放置在更便宜的存储上。

* CPU、主存、外部存储的速度差异持续在扩大。



* Cache Memory（高速缓存）在cpu芯片中的SRAM。存储主存中经常需要访问的块。
* 高速缓存的划分：组 + 行 + 块。通常是多路组关联（即一组包含多个缓存行）。块大小是64字节。
* 对于函数的局部变量，编译器可能会把它放在寄存器中；而全局变量可能就不会；性能差异显著。



* 矩阵乘法的不同排列模式（重新安排循环的遍历方式），其局部性差异巨大，性能也相差很多。

